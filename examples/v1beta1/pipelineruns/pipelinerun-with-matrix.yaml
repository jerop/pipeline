apiVersion: tekton.dev/v1beta1
kind: Task
metadata:
  name: platform-browsers
  annotations:
    description: |
      A task that does something cool with platforms and browsers
spec:
  params:
    - name: platform
    - name: browser
  steps:
    - name: echo
      image: alpine
      script: |
        echo "$(params.platform) and $(params.browser)"
---
# run platform-browsers task with:
#   platforms: linux, mac, windows
#   browsers: chrome, safari, firefox
apiVersion: tekton.dev/v1beta1
kind: PipelineRun
metadata:
  generateName: unmatrixed-pr-
spec:
  serviceAccountName: 'default'
  pipelineSpec:
    tasks:
      - name: platforms-and-browsers-1
        params:
          - name: platform
            value: linux
          - name: browser
            value: chrome
        taskRef:
          name: platform-browsers
      - name: platforms-and-browsers-2
        params:
          - name: platform
            value: linux
          - name: browser
            value: safari
        taskRef:
          name: platform-browsers
      - name: platforms-and-browsers-3
        params:
          - name: platform
            value: linux
          - name: browser
            value: firefox
        taskRef:
          name: platform-browsers
      - name: platforms-and-browsers-4
        params:
          - name: platform
            value: mac
          - name: browser
            value: chrome
        taskRef:
          name: platform-browsers
      - name: platforms-and-browsers-5
        params:
          - name: platform
            value: mac
          - name: browser
            value: safari
        taskRef:
          name: platform-browsers
      - name: platforms-and-browsers-6
        params:
          - name: platform
            value: mac
          - name: browser
            value: firefox
        taskRef:
          name: platform-browsers
      - name: platforms-and-browsers-7
        params:
          - name: platform
            value: windows
          - name: browser
            value: chrome
        taskRef:
          name: platform-browsers
      - name: platforms-and-browsers-8
        params:
          - name: platform
            value: windows
          - name: browser
            value: safari
        taskRef:
          name: platform-browsers
      - name: platforms-and-browsers-9
        params:
          - name: platform
            value: windows
          - name: browser
            value: firefox
        taskRef:
          name: platform-browsers
---
# run platform-browsers task with:
#   platforms: linux, mac, windows
#   browsers: chrome, safari, firefox
apiVersion: tekton.dev/v1beta1
kind: PipelineRun
metadata:
  generateName: matrixed-pr-
spec:
  serviceAccountName: 'default'
  pipelineSpec:
    tasks:
      - name: platforms-and-browsers
        matrix:
          - name: platform
            value:
              - linux
              - mac
              - windows
          - name: browser
            value:
              - chrome
              - safari
              - firefox
        taskRef:
          name: platform-browsers
